# InviteLink Architecture & Deployment Flow

## ğŸ—ï¸ Overall System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           INVITELINK DEPLOYMENT ARCHITECTURE                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEVELOPER'S MACHINE                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Git Repository (Local)                                                     â”‚
â”‚  â”œâ”€ backend/          (C# .NET Code)                                        â”‚
â”‚  â”œâ”€ frontend/         (React Native)                                        â”‚
â”‚  â”œâ”€ infra/            (Terraform IaC)                                       â”‚
â”‚  â””â”€ .github/workflows/  (CI/CD Pipelines)                                   â”‚
â”‚                                                                              â”‚
â”‚  $ git push â†’ GitHub Repository                                            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GITHUB.COM                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Repository: satar614/InviteLink                                            â”‚
â”‚  â”œâ”€ Pull Requests (auto-create namespace)                                   â”‚
â”‚  â””â”€ Push to main (deploy to main namespace)                                 â”‚
â”‚                                                                              â”‚
â”‚  GitHub Actions Triggers:                                                   â”‚
â”‚  â”œâ”€ Path: infra/**     â†’ deploy-infra.yml                                   â”‚
â”‚  â”œâ”€ Path: backend/**   â†’ deploy-backend.yml                                 â”‚
â”‚  â””â”€ Path: frontend/**  â†’ deploy-frontend.yml                                â”‚
â”‚                                                                              â”‚
â”‚  GitHub Secrets (encrypted):                                                â”‚
â”‚  â”œâ”€ AZURE_CREDENTIALS                                                       â”‚
â”‚  â”œâ”€ ACR_LOGIN_SERVER                                                        â”‚
â”‚  â”œâ”€ ACR_USERNAME                                                            â”‚
â”‚  â”œâ”€ ACR_PASSWORD                                                            â”‚
â”‚  â”œâ”€ AKS_CLUSTER_NAME                                                        â”‚
â”‚  â””â”€ AKS_RESOURCE_GROUP                                                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                           â†“                           â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PIPELINE 1:         â”‚  â”‚  PIPELINE 2:         â”‚  â”‚  PIPELINE 3:         â”‚
â”‚  INFRASTRUCTURE      â”‚  â”‚  BACKEND API         â”‚  â”‚  FRONTEND            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚
â”‚ deploy-infra.yml     â”‚  â”‚ deploy-backend.yml   â”‚  â”‚ deploy-frontend.yml  â”‚
â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚
â”‚ Triggers:            â”‚  â”‚ Triggers:            â”‚  â”‚ Triggers:            â”‚
â”‚ â€¢ infra/** changes   â”‚  â”‚ â€¢ backend/** changes â”‚  â”‚ â€¢ frontend/** change â”‚
â”‚ â€¢ .github/* changes  â”‚  â”‚ â€¢ .github/* changes  â”‚  â”‚ â€¢ .github/* changes  â”‚
â”‚                      â”‚  â”‚                      â”‚  â”‚                      â”‚
â”‚ 1. Terraform init    â”‚  â”‚ 1. Restore deps      â”‚  â”‚ 1. npm install       â”‚
â”‚ 2. Terraform plan    â”‚  â”‚ 2. Build & test      â”‚  â”‚ 2. npm run test      â”‚
â”‚ 3. Terraform apply   â”‚  â”‚ 3. Build Docker      â”‚  â”‚ 3. npm run build     â”‚
â”‚    (main only)       â”‚  â”‚ 4. Push to ACR       â”‚  â”‚ 4. Build Docker      â”‚
â”‚                      â”‚  â”‚ 5. Deploy to AKS     â”‚  â”‚ 5. Push to ACR       â”‚
â”‚                      â”‚  â”‚ 6. Wait for rollout  â”‚  â”‚ 6. Deploy to AKS     â”‚
â”‚ Resources Deployed:  â”‚  â”‚ 7. Get service info  â”‚  â”‚ 7. Wait for rollout  â”‚
â”‚ â€¢ AKS Cluster        â”‚  â”‚                      â”‚  â”‚ 8. Get service info  â”‚
â”‚ â€¢ ACR Registry       â”‚  â”‚ Namespace:           â”‚  â”‚                      â”‚
â”‚ â€¢ Networking         â”‚  â”‚ â€¢ PR: pr-{number}    â”‚  â”‚ Namespace:           â”‚
â”‚ â€¢ Storage (optional) â”‚  â”‚ â€¢ Main: main         â”‚  â”‚ â€¢ PR: pr-{number}    â”‚
â”‚                      â”‚  â”‚                      â”‚  â”‚ â€¢ Main: main         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                           â”‚                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AZURE CLOUD PLATFORM                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Azure Container Registry (ACR)                                         â”‚ â”‚
â”‚  â”‚ â€¢ smartinvite-api:main-{sha}                                           â”‚ â”‚
â”‚  â”‚ â€¢ smartinvite-api:pr-{number}-{sha}                                    â”‚ â”‚
â”‚  â”‚ â€¢ invitelink-frontend:main-{sha}                                       â”‚ â”‚
â”‚  â”‚ â€¢ invitelink-frontend:pr-{number}-{sha}                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â†“                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Azure Kubernetes Service (AKS) Cluster                                 â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚   Namespace:     â”‚  â”‚   Namespace:     â”‚  â”‚   Namespace:     â”‚   â”‚ â”‚
â”‚  â”‚  â”‚   main           â”‚  â”‚   pr-5           â”‚  â”‚   pr-6           â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚   Backend    â”‚ â”‚  â”‚ â”‚   Backend    â”‚ â”‚  â”‚ â”‚   Backend    â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚   Pods (2)   â”‚ â”‚  â”‚ â”‚   Pods (2)   â”‚ â”‚  â”‚ â”‚   Pods (2)   â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚   Frontend   â”‚ â”‚  â”‚ â”‚   Frontend   â”‚ â”‚  â”‚ â”‚   Frontend   â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â”‚   Pods (2)   â”‚ â”‚  â”‚ â”‚   Pods (2)   â”‚ â”‚  â”‚ â”‚   Pods (2)   â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ Service:         â”‚  â”‚ Service:         â”‚  â”‚ Service:         â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ backend: 80    â”‚  â”‚ â€¢ backend: 80    â”‚  â”‚ â€¢ backend: 80    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ frontend: 80   â”‚  â”‚ â€¢ frontend: 80   â”‚  â”‚ â€¢ frontend: 80   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                  â”‚  â”‚                  â”‚  â”‚                  â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ External IPs:    â”‚  â”‚ External IPs:    â”‚  â”‚ External IPs:    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ api.prod       â”‚  â”‚ â€¢ api.pr-5       â”‚  â”‚ â€¢ api.pr-6       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ www.prod       â”‚  â”‚ â€¢ www.pr-5       â”‚  â”‚ â€¢ www.pr-6       â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                                                                        â”‚ â”‚
â”‚  â”‚  Node Pool: 2+ nodes (auto-scaling available)                        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  Azure Database (SQL Server or PostgreSQL)                                  â”‚
â”‚  â””â”€ Connection string injected as secret to each namespace                  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ CI/CD Pipeline Flow

### Pull Request Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Developer creates/updates PR      â”‚
â”‚   with changes to backend/          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GitHub Actions Triggered   â”‚
        â”‚  (PR event)                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  deploy-backend.yml executes:       â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚  1. Checkout code                   â”‚
    â”‚  2. Setup .NET                      â”‚
    â”‚  3. Restore & Build                 â”‚
    â”‚  4. Run tests                       â”‚
    â”‚  5. Build Docker image              â”‚
    â”‚  6. Login to ACR                    â”‚
    â”‚  7. Push image (pr-{n}-{sha})       â”‚
    â”‚  8. Get AKS credentials             â”‚
    â”‚  9. Create namespace: pr-5          â”‚
    â”‚  10. Create ACR secret              â”‚
    â”‚  11. Deploy to pr-5 namespace       â”‚
    â”‚  12. Wait for rollout success       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Backend live in pr-5 namespace â”‚
        â”‚  Ready for testing              â”‚
        â”‚  Independent endpoints created  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Developer tests in pr-5     â”‚
            â”‚  (while other PRs run in     â”‚
            â”‚   pr-6, pr-7, etc.)          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  PR is merged to main        â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  All pipelines re-run        â”‚
            â”‚  on main branch              â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Deployment to main          â”‚
            â”‚  namespace (production)      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Main Branch Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PR merged to main                 â”‚
â”‚   Commit pushed to main             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GitHub Actions Triggered   â”‚
        â”‚  (push to main)             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Changed files detected:                â”‚
    â”‚  â”œâ”€ backend/ changed?                   â”‚
    â”‚  â”œâ”€ frontend/ changed?                  â”‚
    â”‚  â””â”€ infra/ changed?                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  All affected pipelines execute:        â”‚
    â”‚                                         â”‚
    â”‚  1. If infra/ changed:                  â”‚
    â”‚     â†’ Terraform applies to Azure        â”‚
    â”‚                                         â”‚
    â”‚  2. If backend/ changed:                â”‚
    â”‚     â†’ Build, push, deploy to main       â”‚
    â”‚                                         â”‚
    â”‚  3. If frontend/ changed:               â”‚
    â”‚     â†’ Build, push, deploy to main       â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Deployments to main namespace:         â”‚
    â”‚  â”œâ”€ Backend v2.1.0 (production)         â”‚
    â”‚  â”œâ”€ Frontend v2.1.0 (production)        â”‚
    â”‚  â””â”€ Infrastructure updated (if needed)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PR Closure Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   PR is closed or merged            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  GitHub Actions Triggered   â”‚
        â”‚  (PR closed event)          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Cleanup job executes:              â”‚
    â”‚                                     â”‚
    â”‚  1. Get AKS credentials             â”‚
    â”‚  2. Delete pr-{number} namespace    â”‚
    â”‚  3. All resources deleted:          â”‚
    â”‚     â€¢ Pods                          â”‚
    â”‚     â€¢ Services                      â”‚
    â”‚     â€¢ ConfigMaps                    â”‚
    â”‚     â€¢ Secrets                       â”‚
    â”‚     â€¢ Volumes                       â”‚
    â”‚     â€¢ External IP addresses         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Resources freed up                 â”‚
    â”‚  Costs reduced                      â”‚
    â”‚  Ready for next PR                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GITHUB (Public)                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Encrypted Secrets (Never exposed in logs):                 â”‚
â”‚  â”œâ”€ AZURE_CREDENTIALS (Service Principal)                   â”‚
â”‚  â”œâ”€ ACR_LOGIN_SERVER                                        â”‚
â”‚  â”œâ”€ ACR_USERNAME                                            â”‚
â”‚  â”œâ”€ ACR_PASSWORD                                            â”‚
â”‚  â”œâ”€ AKS_CLUSTER_NAME                                        â”‚
â”‚  â””â”€ AKS_RESOURCE_GROUP                                      â”‚
â”‚                                                              â”‚
â”‚  Encrypted Secrets are injected into workflow as env vars   â”‚
â”‚  (Available only during job execution)                      â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ OAuth 2.0 Token          â”‚
        â”‚ (GitHub Actions)          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AZURE (Private)                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Service Principal (sp-github-actions)                      â”‚
â”‚  â”œâ”€ Limited to specific role (Contributor)                  â”‚
â”‚  â”œâ”€ Scoped to subscription                                  â”‚
â”‚  â””â”€ Can be revoked at any time                              â”‚
â”‚                                                              â”‚
â”‚  Access Control:                                            â”‚
â”‚  â”œâ”€ Container Registry â†’ Image pull/push                    â”‚
â”‚  â”œâ”€ AKS â†’ Deploy/manage resources                           â”‚
â”‚  â””â”€ Database â†’ Connection strings (separate secrets)        â”‚
â”‚                                                              â”‚
â”‚  Network Security:                                          â”‚
â”‚  â”œâ”€ HTTPS only (TLS 1.2+)                                   â”‚
â”‚  â”œâ”€ Private endpoints (optional)                            â”‚
â”‚  â””â”€ Network policies on AKS                                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ˆ Resource Usage Pattern

```
Resource Usage Over Time During Multiple PR Development

                     CPU/Memory Usage
                           â†‘
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â”‚             â”‚
                    â”‚  pr-7       â”‚
              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”      â”‚
              â”‚            â”‚      â”‚
              â”‚   pr-6     â”‚  pr-8â”‚
          â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚      â”‚
          â”‚            â”‚   â”‚      â”‚
      pr-5â”‚   pr-4  pr-3â”‚ pr-2   â”‚
      â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”´â”€â”€â”   â”‚
      â”‚  PR Deployments      â”‚   â”‚
      â”‚  (Isolated)          â”‚   â”‚
  â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Time
      â”‚                      â”‚    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
                                  â”‚
                          pr-1 closed
                          Namespace deleted
                          Resources freed

Benefits:
â€¢ Multiple developers work independently
â€¢ Resources shared efficiently
â€¢ Automatic cleanup prevents resource waste
â€¢ Cost predictable (main + active PRs only)
```

## ğŸ¯ Routing Architecture

```
Internet Traffic
       â”‚
       â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Azure Load Balancer        â”‚
    â”‚  (per namespace)            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â†“                 â†“
main:443          pr-5:443
    â”‚                 â”‚
    â†“                 â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚Ingress   â”‚    â”‚Ingress   â”‚
  â”‚/api/*    â”‚    â”‚/api/*    â”‚
  â”‚/         â”‚    â”‚/         â”‚
  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
   â†“          â†“    â†“          â†“
Backend   Frontend Backend   Frontend
Service   Service  Service   Service
main      main     pr-5      pr-5
   â”‚          â”‚       â”‚         â”‚
   â†“          â†“       â†“         â†“
Backend    Frontend Backend    Frontend
Pods (2)   Pods (2) Pods (2)   Pods (2)
```

## ğŸ“Š Image Versioning Strategy

```
Docker Image Repository
â”œâ”€â”€ smartinvite-api
â”‚   â”œâ”€â”€ main-a1b2c3d4 â† Latest main deployment
â”‚   â”œâ”€â”€ main-x7y8z9w0 â† Previous main deployment
â”‚   â”œâ”€â”€ pr-5-e5f6g7h8 â† PR #5 current version
â”‚   â”œâ”€â”€ pr-5-i9j0k1l2 â† PR #5 previous version
â”‚   â”œâ”€â”€ pr-6-m3n4o5p6 â† PR #6 current version
â”‚   â””â”€â”€ latest        â† Always points to latest (main)
â”‚
â”œâ”€â”€ invitelink-frontend
â”‚   â”œâ”€â”€ main-a1b2c3d4
â”‚   â”œâ”€â”€ main-x7y8z9w0
â”‚   â”œâ”€â”€ pr-5-e5f6g7h8
â”‚   â”œâ”€â”€ pr-5-i9j0k1l2
â”‚   â”œâ”€â”€ pr-6-m3n4o5p6
â”‚   â””â”€â”€ latest

Benefits of SHA-based tagging:
âœ“ Traceability: Exactly which commit is deployed
âœ“ Rollback: Easy to redeploy any version
âœ“ Testing: Reproduce exact environment
âœ“ Auditing: Full deployment history
```

---

**This architecture supports:**
- âœ… Concurrent PR deployments
- âœ… Production isolation
- âœ… Automatic resource cleanup
- âœ… Horizontal scaling
- âœ… High availability (2+ replicas per deployment)
- âœ… Zero-downtime deployments (rolling updates)
- âœ… Complete disaster recovery
